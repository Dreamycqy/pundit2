<!-- buildexamples:section header --><!-- /buildexamples -->

<script>

var ContextualMenuDemoCtrl = function($scope, $rootScope, $dropdown, $timeout, ContextualMenu) {

        var submenuContent = [
            { "text": "Submenu Action1", "href": "#"},
            { "text": "Submenu Action2", "href": "#"}
        ];

        var menuActions = [
            {
                name: 'consoleLog',
                type: 'type1',
                label: "Click to exe console.log",
                showIf: function(){
                    return true;
                },
                action: function(){
                    console.log('exe action 2');
                }
            },
            {
                label: "This open a submenu",
                name: "submenuName",
                type: 'submenu',
                showIf: function(){
                    return true;
                },
                action : {
                    hover: function(){
                        var options = {scope: $rootScope.$new()};
                        options.scope.content = submenuContent;
                        // remove submenu inside submenu
                        options.placement = 'right';
                        options.template = 'src/Toolbar/dropdown.tmpl.html';
                        // build menu
                        submenu = $dropdown(angular.element('.dropdown-submenu'), options);
                        submenu.$promise.then(function(){
                            submenu.show();
                            submenu.$element.hover(function(){
                                submenuOver = true;
                            }, function(){
                                submenuOver = false;
                                submenu.hide();
                                submenu.destroy();
                            });
                        });
                    },
                    leave: function(){
                        $timeout(function() {
                            if ( submenu && !submenuOver) {
                                submenu.hide();
                                submenu.destroy();
                            }
                        }, 100);
                        
                    }
                }                
            }
        ];

    $scope.show = function(position){
        ContextualMenu.show(position, 250, 100);
    };

    $scope.show2 = function(position){
        ContextualMenu.show(position);
    };

    $scope.hide = function($event){
        ContextualMenu.hide();
        $event.stopPropagation();
    };

    var exampleAction = function(){
        console.log('example action execute');
    };

    var l = menuActions.length-1;
    $scope.addAction = function($event){
        if(l>=0){
            var e = menuActions[l];
            ContextualMenu.addAction(e.name, e.label, e.type, e.showIf, e.action);
            l--;
        }
        $event.stopPropagation();
    };

    $scope.displayMenu = function($event){
        ContextualMenu.show('bottom-left', $event.clientX, $event.clientY);
    };

}

</script>

<div data-ng-app="Pundit2" class="pnd-wrp">

    <div class="contexMenu-example-div" ng-controller="ContextualMenuDemoCtrl" ng-click="displayMenu($event)">
        <br><br><br>
        <br><br><br>
        <br><br><br>
        Click on Show button or click at any position to show menu.<br>
        Menu show with default action.<br>
        Hide (click again or click hide button).<br>
        Click addAction button to add custom action (submenu and generic function).<br>
        Now show menu again with custom actions.<br>
        <br><br><br>

        <button type="button" class="pnd-contexMenu-show-btn btn btn-default" ng-click="show()">Show Menu</button>
        <button type="button" class="pnd-contexMenu-show-btn btn btn-default" ng-click="hide($event)">Hide and Remove Menu</button>
        <button type="button" class="pnd-contexMenu-show-btn btn btn-default" ng-click="addAction($event)">Add Action</button>

    </div>

    <br><br><br>
    <br><br><br>
    <br><br><br>

</div>

<!-- buildexamples:section footer --><!-- /buildexamples -->