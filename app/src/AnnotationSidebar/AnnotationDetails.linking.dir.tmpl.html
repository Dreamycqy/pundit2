<div class="pnd-annotation-details-wrap pnd-annotation-semantic pnd-ignore">

    <!-- Collapsed view of the annotation -->
    <div class="pnd-annotation-collapsed pnd-annotation-details-header pnd-annotation-details-top"
        ng-click="toggleAnnotation()"
        ng-if="!annotation.expanded"
        ng-class="{'pnd-annotation-details-broken': annotation.broken, 'pnd-annotation-details-ghosted': annotation.ghosted}">

        <div class="pnd-annotation-collapsed-subject"
            ng-class="{'pnd-annotation-page': annotation.mainItem.typeLabel == 'WebPage'}">
            <span>{{annotation.mainItem.label}}</span>
        </div>

        <div class="pnd-annotation-collapsed-caret"></div>

        <div class="pnd-annotation-collapsed-object">
            <span>{{ annotation.itemsArray[0].objects[0].label }}</span>
        </div>
    </div>
    <!-- END // Collapsed view of the annotation -->

    <!-- Expanded view of the annotation -->
    <div class="pnd-annotation-expanded pnd-annotation-details-container"
         ng-if="annotation.expanded">

        <!-- All'annotazione apert andrebbe aggiunto ng-click="toggleAnnotation()"
            ma va fatto in modo che i pulsanti interni siamo cliccabili e non triggerino
            il toggleAnnotation() -->

        <!-- Metadata -->
        <div class="pnd-annotation-details-meta"
             ng-init="meta = false">

            <img class="pnd-annotation-user-thumb" src="http://placehold.it/30x30" alt="{{::annotation.creatorName}}"/>
            <span class="pnd-annotation-user-name">
                {{::annotation.creatorName}}
            </span>
            <span class="pnd-annotation-metadata">
                {{::annotation.created | date : 'd MMM y'}} · in <span class="pnd-annotation-notebook-name">{{annotation.notebookName}}</span>
            </span>

        </div>

        <!-- Annotation data -->
        <div class="pnd-annotation-details-data">

            <!-- Single Triple -->
            <!-- TODO Fare una modifica qui e togliere la logica di accorpamento degli object se viene utlizzato stesso subject-predicate -->
            <div class="pnd-annotation-details-triple" ng-repeat="item in annotation.itemsArray">

                <div class="pnd-annotation-details-subject pnd-annotation-annotated-fragment">
                    <span>
                        {{item.subject.label}}
                    </span>
                </div>

                <div class="pnd-annotation-details-predicate"
                     data-trigger="hover" data-type="success" data-title="{{item.predicate.description}}" bs-tooltip>
                    {{item.predicate.label}}
                </div>

                <div class="pnd-annotation-details-object">

                    <!-- Thumb -->
                    <span ng-if="item.objects[0].typeLabel != 'Text fragment' && item.objects[0].typeClass != 'literal' && item.objects[0].typeClass != 'WebPage' && item.objects[0].image!='null'"
                          class="pnd-annotation-details-object-image">
                        <img src="{{item.objects[0].image}}" alt="{{item.objects[0].label}}"/>
                    </span>

                    <!-- Label -->
                    <span ng-if="item.objects[0].typeLabel != 'Text fragment' && item.objects[0].typeClass != 'literal'"
                          class="pnd-annotation-details-object-label">
                        {{item.objects[0].label}}
                        <a ng-if="item.objects[0].typeLabel != 'Text fragment' && item.objects[0].typeClass != 'literal'"
                           href="{{item.objects[0].uri}}" target="_blank"><span class="pnd-icon-arrow-right"></span></a>
                    </span>

                    <!-- Type -->
                    <span ng-if="item.objects[0].typeLabel != 'Text fragment' && item.objects[0].typeClass != 'literal'"
                          class="pnd-annotation-details-object-type pnd-type">
                        {{item.objects[0].typeLabel}}
                    </span>

                    <!-- Description  -->
                    <span ng-if="item.objects[0].typeLabel != 'Text fragment' && item.objects[0].typeClass != 'literal' && item.objects[0].typeClass != 'WebPage'"
                          class="pnd-annotation-details-object-description">
                        {{item.objects[0].description | limitTo:50}}
                    </span> <!-- TODO Esiste una versione tagliata dopo N caratteri della description? -->

                    <span ng-if="item.objects[0].typeLabel == 'Text fragment' || item.objects[0].typeClass == 'literal'"
                          class="pnd-annotation-details-object-description">
                        {{item.objects[0].label | limitTo:50}}
                    </span>

                </div>

            </div>
            <!-- END // Single Triple -->

        </div>

        <!-- Annotation functions buttons (Edit, Cancel, Share, Reply, Like...) -->
        <!-- Attenzione vanno rimessi tutto i vari ng-if e ng-show -->
        <div class="pnd-annotation-details-buttons">
            <div
                    class="pnd-annotation-details-footer"
                    >
                <button
                    type="button"
                    class="pnd-edit"
                    ng-click="editComment()">
                    <span class="pnd-icon-pencil"></span>
                    Edit
                </button> · <button
                    type="button"
                    class="pnd-delete"
                    ng-click="deleteAnnotation()">
                    <span class="pnd-icon-trash"></span>
                    Delete
                </button>
            </div>
        </div>

    </div>

</div>